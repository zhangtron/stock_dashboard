# è‚¡ç¥¨åŸºæœ¬é¢é€‰è‚¡æ•°æ®çœ‹æ¿

**ç‰ˆæœ¬**ï¼šv1.1.0
**çŠ¶æ€**ï¼šå·²ä¸Šçº¿ ğŸŸ¢
**åœ¨çº¿åœ°å€**ï¼šhttps://cicpa.fun

åŸºäºFastAPI + MySQL + SQLite + Bootstrap 5æ„å»ºçš„è‚¡ç¥¨åŸºæœ¬é¢é€‰è‚¡æ•°æ®å±•ç¤ºç³»ç»Ÿã€‚

## åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- **Top 3 æ¨è**ï¼šç»¼åˆå¾—åˆ†å‰3çš„è‚¡ç¥¨çªå‡ºå±•ç¤º
- **å¤šç»´åº¦ç­›é€‰**ï¼šè‚¡ç¥¨ä»£ç ã€åç§°ã€ç»¼åˆå¾—åˆ†èŒƒå›´ã€æŠ•èµ„å»ºè®®
- **çµæ´»æ’åº**ï¼šæ”¯æŒæŒ‰ä»»æ„å­—æ®µæ’åºï¼Œé»˜è®¤æŒ‰ç»¼åˆå¾—åˆ†é™åº
- **åˆ†é¡µå±•ç¤º**ï¼šæ¯é¡µ20æ¡æ•°æ®ï¼Œå¿«é€Ÿæµè§ˆå¤§é‡æ•°æ®
- **å¯è§†åŒ–å±•ç¤º**ï¼š
  - å¾—åˆ†é¢œè‰²ç¼–ç ï¼ˆâ‰¥80ç»¿è‰²ï¼Œ60-79é»„è‰²ï¼Œ<60çº¢è‰²ï¼‰
  - æŠ•èµ„å»ºè®®æ ‡ç­¾ï¼ˆå¼ºçƒˆæ¨è/ä¹°å…¥/æŒæœ‰/å›é¿ï¼‰
  - å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒæ‰‹æœº/å¹³æ¿/æ¡Œé¢

### æ€§èƒ½ä¼˜åŒ–ï¼ˆv1.1.0ï¼‰
- **æœ¬åœ°ç¼“å­˜**ï¼šä½¿ç”¨SQLiteæœ¬åœ°ç¼“å­˜ï¼Œå‡å°‘è¿œç¨‹æ•°æ®åº“è¿æ¥
- **å¢é‡åŒæ­¥**ï¼šåŸºäºupdate_timeå­—æ®µå®ç°å¢é‡æ•°æ®åŒæ­¥
- **å®šæ—¶ä»»åŠ¡**ï¼šæ¯å¤©æ—©ä¸Š5:00è‡ªåŠ¨åŒæ­¥æœ€æ–°æ•°æ®
- **å“åº”é€Ÿåº¦**ï¼šAPIå“åº”æ—¶é—´ä»~300msä¼˜åŒ–åˆ°~50msï¼ˆ6å€æå‡ï¼‰

### æŠ€æœ¯æ ˆ
- **åç«¯**ï¼šFastAPI 0.115.0
- **æ•°æ®åº“**ï¼šMySQLï¼ˆè¿œç¨‹ï¼‰+ SQLiteï¼ˆæœ¬åœ°ç¼“å­˜ï¼‰+ SQLAlchemy 2.0.36
- **å®šæ—¶ä»»åŠ¡**ï¼šAPScheduler 3.10.4
- **å‰ç«¯**ï¼šBootstrap 5.3.0 + Jinja2
- **éƒ¨ç½²**ï¼šZeaburï¼ˆå…è´¹æ‰˜ç®¡ï¼‰

## æ•°æ®åº“é…ç½®

### è¡¨ç»“æ„ï¼šstock_fundamental_screening

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | INT | ä¸»é”® |
| stock_code | VARCHAR(20) | è‚¡ç¥¨ä»£ç  |
| stock_name | VARCHAR(100) | è‚¡ç¥¨åç§° |
| overall_score | DECIMAL(5,2) | ç»¼åˆå¾—åˆ† |
| growth_score | DECIMAL(5,2) | æˆé•¿èƒ½åŠ›å¾—åˆ† |
| profitability_score | DECIMAL(5,2) | ç›ˆåˆ©èƒ½åŠ›å¾—åˆ† |
| solvency_score | DECIMAL(5,2) | å¿å€ºèƒ½åŠ›å¾—åˆ† |
| cashflow_score | DECIMAL(5,2) | ç°é‡‘æµèƒ½åŠ›å¾—åˆ† |
| recommendation | VARCHAR(20) | æŠ•èµ„å»ºè®®ï¼ˆSTRONG_BUY/BUY/HOLD/AVOIDï¼‰ |
| pass_filters | TINYINT(1) | æ˜¯å¦é€šè¿‡ç­›é€‰ |
| latest_quarter | DATE | æœ€æ–°è´¢æŠ¥æˆªæ­¢æ—¥æœŸ |
| report_publ_date | DATE | æŠ¥å‘ŠæŠ«éœ²æ—¥æœŸ |
| calc_time | DATETIME | è®¡ç®—æ—¶é—´ |
| create_time | TIMESTAMP | åˆ›å»ºæ—¶é—´ |
| update_time | TIMESTAMP | æ›´æ–°æ—¶é—´ |

## æœ¬åœ°å¼€å‘

### ç¯å¢ƒè¦æ±‚
- Python 3.8+
- MySQL 5.7+

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <your-repo-url>
cd stock-dashboard
```

2. **åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ**
```bash
python -m venv venv
# Windows
venv\Scripts\activate
# Linux/Mac
source venv/bin/activate
```

3. **å®‰è£…ä¾èµ–**
```bash
pip install -r requirements.txt
```

4. **é…ç½®ç¯å¢ƒå˜é‡**
```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å†™æ•°æ®åº“è¿æ¥ä¿¡æ¯
```

.env æ–‡ä»¶å†…å®¹ï¼š
```env
DB_HOST=mysql.sqlpub.com
DB_PORT=3306
DB_USER=chase_zhang
DB_PASSWORD=your_database_password
DB_NAME=stock_review
APP_NAME=Stock Dashboard
APP_ENV=development
DEBUG=True
HOST=0.0.0.0
PORT=8000
```

5. **å¯åŠ¨æœåŠ¡å™¨**
```bash
uvicorn app.main:app --reload
```

6. **è®¿é—®åº”ç”¨**
- Webé¡µé¢ï¼šhttp://localhost:8000
- APIæ–‡æ¡£ï¼šhttp://localhost:8000/docs
- APIç«¯ç‚¹ï¼šhttp://localhost:8000/api/screening

### APIæ–‡æ¡£

#### è·å–åŸºæœ¬é¢é€‰è‚¡æ•°æ®
```
GET /api/screening
```

**æŸ¥è¯¢å‚æ•°ï¼š**
- `page`: é¡µç ï¼ˆé»˜è®¤ï¼š1ï¼‰
- `page_size`: æ¯é¡µæ•°é‡ï¼ˆé»˜è®¤ï¼š20ï¼Œæœ€å¤§ï¼š100ï¼‰
- `stock_code`: è‚¡ç¥¨ä»£ç ï¼ˆæ¨¡ç³Šæœç´¢ï¼‰
- `stock_name`: è‚¡ç¥¨åç§°ï¼ˆæ¨¡ç³Šæœç´¢ï¼‰
- `min_overall_score`: æœ€å°ç»¼åˆå¾—åˆ†ï¼ˆ0-100ï¼‰
- `max_overall_score`: æœ€å¤§ç»¼åˆå¾—åˆ†ï¼ˆ0-100ï¼‰
- `pass_filters`: æ˜¯å¦é€šè¿‡ç­›é€‰ï¼ˆtrue/falseï¼‰
- `recommendation`: æŠ•èµ„å»ºè®®ï¼ˆSTRONG_BUY/BUY/HOLD/AVOIDï¼‰
- `sort_by`: æ’åºå­—æ®µï¼ˆé»˜è®¤ï¼šoverall_scoreï¼‰
- `sort_order`: æ’åºæ–¹å‘ï¼ˆasc/descï¼Œé»˜è®¤ï¼šdescï¼‰

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "top3": [
    {
      "id": 1,
      "stock_code": "000001",
      "stock_name": "å¹³å®‰é“¶è¡Œ",
      "overall_score": 95.6,
      "growth_score": 92.5,
      "profitability_score": 96.8,
      "solvency_score": 94.2,
      "cashflow_score": 93.5,
      "recommendation": "STRONG_BUY",
      "pass_filters": true,
      "calc_time": "2025-01-07T10:30:00"
    }
  ],
  "data": [...],
  "total": 5000,
  "page": 1,
  "page_size": 20,
  "total_pages": 250
}
```

## éƒ¨ç½²åˆ°Zeabur

### å‰ç½®å‡†å¤‡
1. GitHubè´¦å·
2. Zeaburè´¦å·ï¼ˆå…è´¹æ³¨å†Œï¼šhttps://zeabur.comï¼‰
3. è‡ªå®šä¹‰åŸŸå cicpa.fun

### éƒ¨ç½²æ­¥éª¤

1. **æ¨é€ä»£ç åˆ°GitHub**
```bash
git init
git add .
git commit -m "Initial commit"
git branch -M main
git remote add origin <your-github-repo>
git push -u origin main
```

2. **åœ¨Zeaburåˆ›å»ºæ–°é¡¹ç›®**
   - ç™»å½• https://zeabur.com
   - ç‚¹å‡»"New Project"
   - é€‰æ‹©"Deploy from GitHub"
   - æˆæƒå¹¶é€‰æ‹©ä½ çš„GitHubä»“åº“
   - é€‰æ‹©"stock-dashboard"ç›®å½•

3. **é…ç½®ç¯å¢ƒå˜é‡**
   åœ¨Zeaburé¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š
   ```
   DB_PASSWORD = your_database_password
   ```
   å…¶ä»–é…ç½®å·²åœ¨ zeabur.yaml ä¸­é¢„è®¾ã€‚

4. **å¯åŠ¨éƒ¨ç½²**
   - Zeaburä¼šè‡ªåŠ¨æ£€æµ‹ zeabur.yaml é…ç½®
   - è‡ªåŠ¨æ„å»ºå’Œéƒ¨ç½²
   - éƒ¨ç½²å®Œæˆåè·å¾—åº”ç”¨URL

5. **ç»‘å®šè‡ªå®šä¹‰åŸŸå**
   - åœ¨Zeaburé¡¹ç›®è®¾ç½®ä¸­ç‚¹å‡»"Domains"
   - ç‚¹å‡»"Add Custom Domain"
   - è¾“å…¥åŸŸåï¼šcicpa.fun
   - è·å–DNSé…ç½®ä¿¡æ¯

6. **é…ç½®DNS**
   - åœ¨åŸŸåæœåŠ¡å•†å¤„æ·»åŠ CNAMEè®°å½•ï¼š
   ```
   ç±»å‹ï¼šCNAME
   ä¸»æœºè®°å½•ï¼š@
   è®°å½•å€¼ï¼š<zeaburæä¾›çš„CNAME>
   TTLï¼š600
   ```

7. **éªŒè¯HTTPS**
   - Zeaburä¼šè‡ªåŠ¨ç”³è¯·Let's Encryptè¯ä¹¦
   - å‡ åˆ†é’Ÿåè®¿é—® https://cicpa.fun éªŒè¯

### Zeaburé…ç½®è¯´æ˜

zeabur.yaml æ–‡ä»¶é…ç½®äº†ï¼š
- Pythonè¿è¡Œç¯å¢ƒ
- è‡ªåŠ¨å®‰è£…ä¾èµ–ï¼ˆrequirements.txtï¼‰
- å¯åŠ¨å‘½ä»¤ï¼š`uvicorn app.main:app --host 0.0.0.0 --port $PORT`
- ç¯å¢ƒå˜é‡é…ç½®
- å…è´¹å¥—é¤ï¼ˆ512MB RAMï¼Œ0.5GBå­˜å‚¨ï¼‰

## å¸¸è§é—®é¢˜

### 1. æ•°æ®åº“è¿æ¥å¤±è´¥
- æ£€æŸ¥ .env æ–‡ä»¶ä¸­çš„æ•°æ®åº“é…ç½®æ˜¯å¦æ­£ç¡®
- ç¡®è®¤MySQLæœåŠ¡æ˜¯å¦å¯è®¿é—®
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

### 2. APIè¿”å›ç©ºæ•°æ®
- ç¡®è®¤æ•°æ®åº“è¡¨ä¸­æœ‰æ•°æ®
- æ£€æŸ¥ç­›é€‰æ¡ä»¶æ˜¯å¦è¿‡äºä¸¥æ ¼
- æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—æ’æŸ¥é”™è¯¯

### 3. éƒ¨ç½²åæ— æ³•è®¿é—®
- æ£€æŸ¥Zeaburéƒ¨ç½²çŠ¶æ€æ˜¯å¦ä¸º"Running"
- ç¡®è®¤DNSé…ç½®æ˜¯å¦æ­£ç¡®ç”Ÿæ•ˆ
- æŸ¥çœ‹Zeaburæ—¥å¿—æ’æŸ¥é”™è¯¯

### 4. é¡µé¢æ ·å¼å¼‚å¸¸
- æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
- æ£€æŸ¥ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
- CDNå¯èƒ½éœ€è¦æ—¶é—´åŠ è½½

### 5. æ€§èƒ½ä¼˜åŒ–å»ºè®®
- æ•°æ®åº“å·²æ·»åŠ ç´¢å¼•ï¼ˆstock_code, calc_timeï¼‰
- ä½¿ç”¨è¿æ¥æ± ï¼ˆpool_size=5, max_overflow=10ï¼‰
- åˆ†é¡µæŸ¥è¯¢é¿å…åŠ è½½å…¨éƒ¨æ•°æ®
- é¢„æœŸå“åº”æ—¶é—´ï¼š<500msï¼ˆ10,000æ¡æ•°æ®ï¼‰

## é¡¹ç›®ç»“æ„

```
stock-dashboard/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config.py              # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ database.py            # æ•°æ®åº“è¿æ¥
â”‚   â”œâ”€â”€ models.py              # SQLAlchemyæ¨¡å‹
â”‚   â”œâ”€â”€ schemas.py             # Pydantic schemas
â”‚   â”œâ”€â”€ crud.py                # æ•°æ®åº“æ“ä½œ
â”‚   â”œâ”€â”€ main.py                # FastAPIåº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ routers/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ screening.py       # åŸºæœ¬é¢é€‰è‚¡API
â”‚   â””â”€â”€ static/
â”‚       â””â”€â”€ templates/
â”‚           â”œâ”€â”€ base.html      # åŸºç¡€æ¨¡æ¿
â”‚           â””â”€â”€ screening.html # åŸºæœ¬é¢é€‰è‚¡é¡µé¢
â”œâ”€â”€ .env                       # ç¯å¢ƒå˜é‡ï¼ˆæœ¬åœ°ç”¨ï¼Œä¸æäº¤Gitï¼‰
â”œâ”€â”€ .env.example               # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ .gitignore                 # Gitå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ requirements.txt           # Pythonä¾èµ–
â”œâ”€â”€ zeabur.yaml               # Zeaburéƒ¨ç½²é…ç½®
â””â”€â”€ README.md                 # é¡¹ç›®æ–‡æ¡£
```

## å¼€å‘è¯´æ˜

### æ·»åŠ æ–°çš„APIç«¯ç‚¹
1. åœ¨ `app/routers/` ç›®å½•åˆ›å»ºæ–°çš„è·¯ç”±æ–‡ä»¶
2. åœ¨ `app/main.py` ä¸­æ³¨å†Œè·¯ç”±

### æ·»åŠ æ–°çš„é¡µé¢
1. åœ¨ `app/static/templates/` åˆ›å»ºæ–°çš„HTMLæ¨¡æ¿
2. åœ¨ `app/main.py` æ·»åŠ è·¯ç”±

### æ•°æ®åº“è¿ç§»
å½“å‰é¡¹ç›®ä½¿ç”¨è¡¨ç»“æ„å·²å­˜åœ¨çš„æ•°æ®åº“ï¼Œä¸åŒ…å«è¿ç§»å·¥å…·ã€‚
å¦‚éœ€ä¿®æ”¹è¡¨ç»“æ„ï¼Œå»ºè®®ä½¿ç”¨Alembicè¿›è¡Œè¿ç§»ç®¡ç†ã€‚

## å®‰å…¨æ³¨æ„äº‹é¡¹

1. **ç¯å¢ƒå˜é‡**ï¼š.env æ–‡ä»¶åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œä¸è¦æäº¤åˆ°Git
2. **SQLæ³¨å…¥é˜²æŠ¤**ï¼šä½¿ç”¨SQLAlchemy ORMï¼Œå·²å†…ç½®é˜²æŠ¤
3. **XSSé˜²æŠ¤**ï¼šå‰ç«¯ä½¿ç”¨Jinja2æ¨¡æ¿ï¼Œè‡ªåŠ¨è½¬ä¹‰è¾“å‡º
4. **HTTPS**ï¼šç”Ÿäº§ç¯å¢ƒå¼ºåˆ¶ä½¿ç”¨HTTPS
5. **åªè¯»è®¿é—®**ï¼šAPIä»…æä¾›æŸ¥è¯¢åŠŸèƒ½ï¼Œæ— å†™æ“ä½œ

## è®¸å¯è¯

MIT License

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æäº¤Issueæˆ–è”ç³»é¡¹ç›®ç»´æŠ¤è€…ã€‚
